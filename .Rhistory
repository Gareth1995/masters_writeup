allresidents[allresidents==0] <- NA
allresidents$allresidents <- as.numeric(allresidents$allresidents)
# migrants
allmigrants <- apply(migrants, 1, sum, na.rm = T)
allmigrants <- as.data.frame(cbind(allmigrants,
'Season' = bp_counts$Season,
'Year' = bp_counts$Year))
allmigrants[allmigrants==0] <- NA
# run jags on barberspan area
bspan.residents <- jags_analysis(allresidents)
bspan.migrants <- jags_analysis(allmigrants)
# plot
#par(mfrow=c(1,2))
resplots <- ts_jag_plot(bspan.residents, allresidents, "residents")
migplots <- ts_jag_plot(bspan.migrants, allmigrants, "migrants")
resplots$summer
resplots$winter
migplots$summer
migplots$winter
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = 'hide')
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.keep = 'all')
library(dplyr)
source("R/cwac_functions.r")
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
#barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
colnames(residents) <- resid$`Common name`
colnames(migrants) <- migid$`Common name`
res.jags <- list()
# for (i in 1:length(residents)){
#   res.jags[[i]] <- jags_analysis(as.data.frame(cbind(residents[,i],
#                                           'Season' = bp_counts$Season,
#                                           'Year' = bp_counts$Year)))
# }
residents
nrow(residents)
ncol(residents)
ncol(migrants)
resid
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
#barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef, `Common name`)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef, `Common name`)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
colnames(residents) <- resid$`Common name`
colnames(migrants) <- migid$`Common name`
res.jags <- list()
# for (i in 1:length(residents)){
#   res.jags[[i]] <- jags_analysis(as.data.frame(cbind(residents[,i],
#                                           'Season' = bp_counts$Season,
#                                           'Year' = bp_counts$Year)))
# }
residents
migrants
nr=col(migrants)
ncol(migrants)
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
negs_m <- 0
pos_m <- 0
numsigs_m <- 0
betas_m <- c()
for(i in 1:length(mig.jags)){
# Check to see if positive or negative trend
meanb_m <- mean(mig.jags[[i]]$mean$beta)
betas_m <- c(betas_m, meanb_m)
if(meanb_m<0){
negs_m <- negs_m+1
}else{
pos_m <- pos_m+1
}
# check if trend is significant
lb_m <- mean(mig.jags[[i]]$q2.5$beta)
ub_m<- mean(mig.jags[[i]]$q97.5$beta)
# is significant
if((lb_m>0 & ub_m>0) | (lb_m<0 & ub_m<0)){
numsigs_m <- numsigs_m+1
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "**", "(Avg Slope =", round(meanb_m,2),")"))
}else{
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "(Avg Slope =", round(meanb_m,2),")"))
}
print(mplot)
}
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
negs_m <- 0
pos_m <- 0
numsigs_m <- 0
betas_m <- c()
for(i in 1:length(mig.jags)){
# Check to see if positive or negative trend
meanb_m <- mean(mig.jags[[i]]$mean$beta)
betas_m <- c(betas_m, meanb_m)
if(meanb_m<0){
negs_m <- negs_m+1
}else{
pos_m <- pos_m+1
}
# check if trend is significant
lb_m <- mean(mig.jags[[i]]$q2.5$beta)
ub_m<- mean(mig.jags[[i]]$q97.5$beta)
# is significant
if((lb_m>0 & ub_m>0) | (lb_m<0 & ub_m<0)){
numsigs_m <- numsigs_m+1
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "**", "(Avg Slope =", round(meanb_m,2),")"))
}else{
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "(Avg Slope =", round(meanb_m,2),")"))
}
print(mplot)
}
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = 'hide')
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.keep = 'all')
library(dplyr)
source("R/cwac_functions.r")
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
#barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef, `Common name`)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef, `Common name`)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
colnames(residents) <- resid$`Common name`
colnames(migrants) <- migid$`Common name`
res.jags <- list()
for (i in 1:length(residents)){
res.jags[[i]] <- jags_analysis(as.data.frame(cbind(residents[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
negs <- 0
pos <- 0
numsigs <- 0
betas <- c()
for(i in 1:length(res.jags)){
# Check to see if positive or negative trend
meanb <- mean(res.jags[[i]]$mean$beta)
betas <- c(betas, meanb)
if(meanb<0){
negs <- negs+1
}else{
pos <- pos+1
}
# check if trend is significant
lb <- mean(res.jags[[i]]$q2.5$beta)
ub <- mean(res.jags[[i]]$q97.5$beta)
# is significant
if((lb>0 & ub>0) | (lb<0 & ub<0)){
numsigs <- numsigs+1
rplot <- ts_jag_plot(res.jags[[i]],
as.data.frame(cbind(residents[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste0(colnames(residents)[i], " (Avg slope = ",round(meanb,2),")", "*"))
}else{
rplot <- ts_jag_plot(res.jags[[i]],
as.data.frame(cbind(residents[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste0(colnames(residents)[i]," (Avg slope = ",round(meanb,2),")"))
}
print(rplot)
}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = 'hide')
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.keep = 'all')
library(dplyr)
source("R/cwac_functions.r")
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
#barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef, `Common name`)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef, `Common name`)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
colnames(residents) <- resid$`Common name`
colnames(migrants) <- migid$`Common name`
# res.jags <- list()
#
# for (i in 1:length(residents)){
#   res.jags[[i]] <- jags_analysis(as.data.frame(cbind(residents[,i],
#                                           'Season' = bp_counts$Season,
#                                           'Year' = bp_counts$Year)))
# }
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
negs_m <- 0
pos_m <- 0
numsigs_m <- 0
betas_m <- c()
for(i in 1:length(mig.jags)){
# Check to see if positive or negative trend
meanb_m <- mean(mig.jags[[i]]$mean$beta)
betas_m <- c(betas_m, meanb_m)
if(meanb_m<0){
negs_m <- negs_m+1
}else{
pos_m <- pos_m+1
}
# check if trend is significant
lb_m <- mean(mig.jags[[i]]$q2.5$beta)
ub_m<- mean(mig.jags[[i]]$q97.5$beta)
# is significant
if((lb_m>0 & ub_m>0) | (lb_m<0 & ub_m<0)){
numsigs_m <- numsigs_m+1
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "**", "(Avg Slope =", round(meanb_m,2),")"))
}else{
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "(Avg Slope =", round(meanb_m,2),")"))
}
print(mplot)
}
citation()
citation("jagsUI")
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = 'hide')
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.keep = 'all')
library(dplyr)
source("R/cwac_functions.r")
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
#barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef, `Common name`)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef, `Common name`)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
colnames(residents) <- resid$`Common name`
colnames(migrants) <- migid$`Common name`
# res.jags <- list()
#
# for (i in 1:length(residents)){
#   res.jags[[i]] <- jags_analysis(as.data.frame(cbind(residents[,i],
#                                           'Season' = bp_counts$Season,
#                                           'Year' = bp_counts$Year)))
# }
mig.jags <- list()
for (i in 1:length(migrants)){
mig.jags[[i]] <- jags_analysis(as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)))
}
negs_m <- 0
pos_m <- 0
numsigs_m <- 0
betas_m <- c()
for(i in 1:length(mig.jags)){
# Check to see if positive or negative trend
meanb_m <- mean(mig.jags[[i]]$mean$beta)
betas_m <- c(betas_m, meanb_m)
if(meanb_m<0){
negs_m <- negs_m+1
}else{
pos_m <- pos_m+1
}
# check if trend is significant
lb_m <- mean(mig.jags[[i]]$q2.5$beta)
ub_m<- mean(mig.jags[[i]]$q97.5$beta)
# is significant
if((lb_m>0 & ub_m>0) | (lb_m<0 & ub_m<0)){
numsigs_m <- numsigs_m+1
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "**", "(Avg Slope =", round(meanb_m,2),")"))
}else{
mplot <- ts_jag_plot(mig.jags[[i]],
as.data.frame(cbind(migrants[,i],
'Season' = bp_counts$Season,
'Year' = bp_counts$Year)),
paste(colnames(migrants)[i], "(Avg Slope =", round(meanb_m,2),")"))
}
print(mplot)
}
source("R/cwac_functions.r")
library(knitr)
library(vegan)
library(tidyverse)
library(cowplot)
library(bayesplot)
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# separate into resident and migrant
resid <- robertsDB %>%
filter(Migrant=="n") %>%
select(SppRef)
migid <- robertsDB %>%
filter(Migrant=="y") %>%
select(SppRef)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
# use a common bird with a fair amount of data (Egyptian goose)
egoose <- as.data.frame(bp_counts[c('89', 'Season', 'Year')])
egoose.jags <- jags_analysis(egoose)
egoose.plot <- ts_jag_plot(egoose.jags, egoose, "Egyptian Goose")
egoose.plot$summer
egoose.plot$winter
source("R/cwac_functions.r")
# use a common bird with a fair amount of data (Egyptian goose)
egoose <- as.data.frame(bp_counts[c('89', 'Season', 'Year')])
egoose.jags <- jags_analysis(egoose)
egoose.plot <- ts_jag_plot(egoose.jags, egoose, "Egyptian Goose")
egoose.plot$summer
egoose.plot$winter
source("R/cwac_functions.r")
egoose.plot <- ts_jag_plot(egoose.jags, egoose, "Egyptian Goose")
egoose.plot$winter
egoose.plot$summer
egoose.plot$winter
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(results = 'hide')
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.keep = 'all')
#knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")
source("R/cwac_functions.r")
library(knitr)
library(vegan)
library(tidyverse)
library(cowplot)
#
# load relevant data
load('data/robertsDB.RData')
load('data/barberspan.counts.RData')
birdcnts <- bp_counts[,1:103]
# counting all the observations with 0 count
barbernas <- apply(birdcnts, 2, function(x){
return(x==0)
})
barbernas
barber0s = apply(barbernas, 2, sum, na.rm = T) # sum the number of 0 counts per bird
less13 = names(barber0s[barber0s>19]) # extract names of the birds with 13 or more counts
#df <- robertsDB %>% select(everything())
newRobert <- robertsDB[!robertsDB$SppRef %in% less13,] # extract only species with 13 or more counts
# separate into resident and migrant
resid <- newRobert %>%
filter(Migrant=="n") %>%
select(SppRef)
migid <- newRobert %>%
filter(Migrant=="y") %>%
select(SppRef)
residents <- birdcnts[,resid$SppRef]
migrants <- birdcnts[,migid$SppRef]
# CAPTION THE IMAGE DESCRIBING THAT THE GREY IS A 95% CI
# LABEL AXIS
# tallying counts for overall analysis of barberspan
# residents
allresidents <- apply(residents, 1, sum, na.rm = T)
allresidents <- as.data.frame(cbind(allresidents,
'Season' = bp_counts$Season,
'Year' = bp_counts$Year))
allresidents[allresidents==0] <- NA
allresidents$allresidents <- as.numeric(allresidents$allresidents)
# migrants
allmigrants <- apply(migrants, 1, sum, na.rm = T)
allmigrants <- as.data.frame(cbind(allmigrants,
'Season' = bp_counts$Season,
'Year' = bp_counts$Year))
allmigrants[allmigrants==0] <- NA
# run jags on barberspan area
bspan.residents <- jags_analysis(allresidents)
bspan.migrants <- jags_analysis(allmigrants)
# plot
#par(mfrow=c(1,2))
resplots <- ts_jag_plot(bspan.residents, allresidents, "residents")
migplots <- ts_jag_plot(bspan.migrants, allmigrants, "migrants")
resplots$summer
resplots$winter
migplots$summer
migplots$winter
